## 在货品管理中添加字段

- can_order：含义是可订/不可订，值为true或false，可为空。

- desc：备注，默认值是"常规规格"，可为空。

<img src="%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/image-20210127204631087.png" alt="image-20210127204631087" style="zoom:50%;" />

## 在分店订购单中添加字段

order_type：订单类型，值为

> 水果类订单、蔬菜类订单、冷冻品订单、混合类订单
>
> 后端：添加订单的时候，要扫描一下所有物品的类别，然后判定这个订单是什么类型
>

搜索订单时，order_type为空或混合类订单，则搜索所有订单，否则按特定类型搜索

## 补充标志位/货品类型

1. 标志位：goods_sort
2. 货品类型：goods_type_id

有三个位置要补充：

1. 订单中订购详情
2. 订购方案中订购详情
3. 单品采购单中的采购详情

下面以订购方案为例做个截图

![81611756153_.pic_hd](%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/81611756153_.pic_hd.jpg)

## 分店订单的采购情况添加金额

就是说采购员完成单品采购时，根据`采购量✖️单价`得出一个金额

<img src="%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/image-20210127231329960.png" alt="image-20210127231329960" style="zoom:50%;" />

## 订购方案修改

订购方案修改：

1. 订购方案被创建时，会属于创建者所在的分店，这意味着，同属一个分店的员工，是共享订购方案的。当员工被转移到其他分店后，其在原来分店创建的方案仍然存在；

2. 获取订购方案时，会获取当前分店的订购方案和所有采购经理的订购方案；

## 补充是否可订字段

对不可订的货，分店订货时不可以填入除0外的数值。

后端将订购方案发过来时，要为方案中的每个货品添加一个是否可订的值，让前端可以判断是否可订。

<img src="%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/wpsvUOC3J.jpg" alt="img" style="zoom:33%;" /> 

## 添加两个用于统计的接口

1. 接口1：查看当天订单提交数（未审批的订单也算进去）

   后端不用为该接口做权限管理，前端弄就好了

   接口返回的数据如下：

| 订货日期：2020-01-17 |              |              |              |
| -------------------- | ------------ | ------------ | ------------ |
| 分店                 | 水果类订单数 | 蔬菜类订单数 | 冷冻品订单数 |
| 清源湾店             | 2            | 1            | 1            |
| 公园店               | 1            |              | 1            |
| ....                 |              |              |              |
|                      |              |              |              |

2. 接口2: 添加一个订购汇总

![image-20210127224213271](%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/image-20210127224213271.png)

注意：未审批的订单也要算进去，这个订购汇总只是对当天订购（含未审批）情况进行提前汇总。

## 添加单品采购单作废功能

- 采购单作废和采购单完成类似，都意味着该单品采购单不需要进行采购了。
- 作废一个采购单时后端需要做的事：
  1. 将采购单的状态设置为`已作废`，并放入历史采购单（采购单完成后也是放入历史采购单对吧？）
  2. 将涉及该采购单的分店订购单中的这个单品的采购量设置为0
  3. 将该采购单涉及到的分店订购单中的“经理备注”中添加“xxx货品的采购已作废”

<img src="%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/image-20210127225656067.png" alt="image-20210127225656067" style="zoom: 67%;" />



## 订单打印的格式修改

目前格式：

<img src="%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/image-20210127232035039.png" alt="image-20210127232035039" style="zoom:50%;" />

要修改成：

1. 注意：那些没订购的物品也要打印出来
2. 注意：按照标志位从大到小来排序

![image-20210127232105349](%E5%90%8E%E7%AB%AF%E4%BF%AE%E6%94%B9%E5%86%85%E5%AE%B9.assets/image-20210127232105349.png)

## 采购员模块好像有bug

具体看文档的第9点

